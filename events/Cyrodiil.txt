namespace = cyrodiil

# Cyrodiil County Flag
country_event = {
	id = cyrodiil.1
	title = "cyrodiil.1.t"
	desc = "cyrodiil.1.d"
	picture = COURT_eventPicture
	hidden = yes

	trigger = {
		OR = {
			tag = Y02
			tag = Y03
			tag = Y04
			tag = Y05
			tag = Y06
			tag = Y07
			tag = Y08
			tag = Y53
		}
		NOT = { has_country_flag = cyrodilic_count }
	}

	option = {
		name = "cyrodiil.1.a"
		set_country_flag = cyrodilic_count
	}
}

# City Isle Flag
country_event = {
	id = cyrodiil.2
	title = "cyrodiil.2.t"
	desc = "cyrodiil.2.d"
	picture = COURT_eventPicture
	hidden = yes

	trigger = {
		tag = Y01
		NOT = { has_country_flag = cityisle_prewar}
		NOT = { has_country_flag = cityisle_postwar}
	}

	option = {
		name = "cyrodiil.2.a"
		set_country_flag = cityisle_prewar
	}
}

# Remove City Isle Flag
country_event = {
	id = cyrodiil.3
	title = "cyrodiil.3.t"
	desc = "cyrodiil.3.d"
	picture = COURT_eventPicture
	hidden = yes

	trigger = {
		has_country_flag = cityisle_prewar
		NOT = { has_country_flag = cityisle_postwar }
		is_at_war = no
	}

	option = {
		name = "cyrodiil.3.a"
		clr_country_flag = cityisle_prewar
		set_country_flag = cityisle_postwar
	}
}

# City Isle Conquest
# TODO: Take war flags into account
province_event = {
	id = cyrodiil.4
	title = "cyrodiil.4.t"
	desc = "cyrodiil.4.d"
	picture = COURT_eventPicture
	hidden = no

	trigger = {
		province_id = 3529
		owned_by = Y01
		NOT = { controlled_by = owner }
		NOT = { controlled_by = REB }
		Y01 = {
			has_country_flag = cityisle_prewar
			NOT = { has_country_flag = cityisle_postwar }
		}
		has_siege = no
	}

	option = {
		name = "cyrodiil.4.a"
		controller = {
			inherit = Y01
			every_province = {
				limit = {
					is_core = Y01
				}
				remove_core = Y01
			}
		}
	}
}

# Gaining The Ruby Throne
country_event = {
	id = cyrodiil.5
	title = "cyrodiil.5.t"
	desc = "cyrodiil.5.d"
	picture = COURT_eventPicture
	hidden = no

	trigger = {
		owns_core_province = 3529
		OR = {
			culture_group = cyrodillic
			culture_group = colovian
		}
		NOT = { exists = Y55 }
		NOT = { has_country_flag = ruby_throne }
		NOT = { has_country_flag = cityisle_prewar }
		NOT = { has_global_flag = stormcrown_interregnum_ended }
		is_at_war = no
	}
	
	option = {
		name = "cyrodiil.5.a"
		set_capital = 3529
		
		set_country_flag = ruby_throne
		if = {
			limit = {
				government_rank = 1
			}
			set_government_rank = 2
		}
		every_country = {
			limit = {
				OR = {
					culture_group = cyrodillic
					culture_group = colovian
				}
			}
			remove_opinion = {
				who = ROOT
				modifier = cyrodiil_warlord_other_opinion
			}
			remove_opinion = {
				who = ROOT
				modifier = cyrodiil_count_count
			}
			clr_country_flag = emperor_county_relations
		}
		
		every_province = {
			limit = {
				region = heartlands_region
			}
			add_permanent_claim = ROOT
		}
	}
}

# Losing The Ruby Throne
country_event = {
	id = cyrodiil.6
	title = "cyrodiil.6.t"
	desc = "cyrodiil.6.d"
	picture = COURT_eventPicture
	hidden = no

	trigger = {
		has_country_flag = ruby_throne
		NOT = { has_global_flag = stormcrown_interregnum_ended }
		NOT = {
			owns_core_province = 3529
		}
	}
	
	option = {
		name = "cyrodiil.6.a"
		clr_country_flag = ruby_throne
		clr_country_flag = cyrodiil_count_opinion
		clr_country_flag = cyrodiil_warlord_emperor_opinion
		
		every_province= {
			limit = {
				superregion = cyrodiil_superregion
			}
			remove_claim = ROOT
		}
		
		every_country = {
			limit = { has_country_flag = cyrodilic_count }
			remove_opinion = {
				who = FROM
				modifier = cyrodiil_count_emperor
			}
		}
		
		every_country = {
			limit = {
				government = cyrodilic_warlord
				NOT = {
					has_country_flag = ruby_throne
				}
			}
			remove_opinion = {
				who = FROM
				modifier = cyrodiil_warlord_other_opinion
			}
		}
	}
}

# End of the Stormcrown Interregnum
country_event = {
	id = cyrodiil.7
	title = "cyrodiil.7.t"
	desc = "cyrodiil.7.d"
	picture = COURT_eventPicture
	is_triggered_only = yes
	hidden = no

	option = {
		name = "cyrodiil.7.a"
		set_global_flag = stormcrown_interregnum_ended
	}
}

# Counties/Towns Join Empire
country_event = {
	id = cyrodiil.8
	title = "cyrodiil.8.t"
	desc = "cyrodiil.8.d"
	picture = COURT_eventPicture
	is_triggered_only = yes
	hidden = no

	# Join The Empire directly
	option = {
		name = "cyrodiil.8.a"
		Y55 = {
			inherit = ROOT
		}

		ai_chance = {
			factor = 1
			
			# Alliance
			modifier = {
				factor = 10
				alliance_with = Y55
			}
			
			# Very high opinion
			modifier = {
				factor = 10
				has_opinion= {
					who = Y55
					value = 175
				}
			}
			
			# Low Development
			modifier = {
				factor = 10
				NOT = { total_development = 25 }
			}
			
			# Inferior Army
			modifier = {
				factor = 10
				NOT = { land_forcelimit = Y55 }
			}
		}
	}
	
	# Join The Empire as an Imperial State
	option = {
		name = "cyrodiil.8.b"
		Y55 = {
			create_subject = {
				subject_type = tamrielic_core_provincial_state
				subject = ROOT
			}
		}
		
		ai_chance = {
			factor = 1
			
			# Alliance
			modifier = {
				factor = 10
				alliance_with = Y55
			}
			
			# Very high opinion
			modifier = {
				factor = 10
				has_opinion= {
					who = Y55
					value = 175
				}
			}
			
			# County
			modifier = {
				factor = 15
				has_country_flag = cyrodilic_count
				NOT = { is_rival = Y55 }
			}
			
			# Have Different Religions
			modifier = {
				factor = 10
				NOT = { has_matching_religion = Y55 }
			}
		}
	}
	
	# Refuse to join The Empire
	option = {
		name = "cyrodiil.8.c"
		Y55 = {
			# TODO: Add Core Province CB
		}
		ai_chance = {
			factor = 1
			
			# Negative Relations
			modifier = {
				factor = 10
				NOT = {
					has_opinion = {
						who = Y55
						value = 0
					}
				}
			}
			
			# Rivalry
			modifier = {
				factor = 10
				is_rival = Y55
			}
			
			# Empire Rank
			modifier = {
				factor = 10
				government_rank = 3
			}
			
			# Have Different Religions
			modifier = {
				factor = 10
				NOT = { has_matching_religion = Y55 }
			}
		}
	}
}

# Former Tamriel Provinces Join Empire
country_event = {
	id = cyrodiil.9
	title = "cyrodiil.9.t"
	desc = "cyrodiil.9.d"
	picture = COURT_eventPicture
	is_triggered_only = yes
	hidden = no

	# Join The Empire as an Imperial State
	option = {
		name = "cyrodiil.9.a"
		Y55 = {
			create_subject = {
				subject_type = tamrielic_provincial_state
				subject = ROOT
			}
		}
		ai_chance = {
			factor = 1
			
			# Alliance
			modifier = {
				factor = 10
				alliance_with = Y55
			}
			
			# Low Development
			modifier = {
				factor = 10
				NOT = { total_development = 25 }
			}
			
			# Not terrible opinion
			modifier = {
				factor = 10
				has_opinion= {
					who = Y55
					value = -35
				}
			}
			
			# Inferior Army
			modifier = {
				factor = 10
				NOT = { land_forcelimit = Y55 }
			}
			
			# Same Religion
			modifier = {
				factor = 10
				has_matching_religion = Y55
			}
		}
	}
	
	# Refuse to join The Empire
	option = {
		name = "cyrodiil.9.b"
		Y55 = {
			# TODO: Add Core Province CB
		}
		ai_chance = {
			factor = 1
			
			# Terrible relations
			modifier = {
				factor = 10
				NOT = {
					has_opinion = {
						who = Y55
						value = -90
					}
				}
			}
			
			# Rivalry
			modifier = {
				factor = 10
				is_rival = Y55
			}
			
			# Empire Rank
			modifier = {
				factor = 10
				government_rank = 3
			}
		}
	}
}

# Emperor-County Relations
country_event = {
	id = cyrodiil.10
	title = "cyrodiil.10.t"
	desc = "cyrodiil.10.d"
	picture = COURT_eventPicture
	hidden = yes

	trigger = {
		has_country_flag = cyrodilic_count
		NOT = { has_country_flag = emperor_county_relations }
		any_country = {
			has_country_flag = ruby_throne
		}
	}

	option = {
		name = "cyrodiil.10.a"
		every_country = {
			limit = {
				has_country_flag = ruby_throne
			}
			
			ROOT = {
				set_country_flag = emperor_county_relations
			}
			
			# Makes sending country like the emperor
			reverse_add_opinion = {
				who = ROOT
				modifier = cyrodiil_count_emperor
			}
		}
	}
}

# County-County Relations
country_event = {
	id = cyrodiil.11
	title = "cyrodiil.11.t"
	desc = "cyrodiil.11.d"
	picture = COURT_eventPicture
	hidden = yes

	trigger = {
		has_country_flag = cyrodilic_count
		NOT = { has_country_flag = ruby_throne }
		any_country = {
			has_country_flag = cyrodilic_count
			NOT = {
				has_opinion_modifier = {
					who = ROOT
					modifier = cyrodiil_count_count
				}
			}
		}
	}
	
	option = {
		name = "cyrodiil.11.a"
		every_country = {
			limit = {
				has_country_flag = cyrodilic_count
				NOT = { has_country_flag = ruby_throne }
				NOT = {
					has_opinion_modifier = {
						who = ROOT
						modifier = cyrodiil_count_count
					}
				}
			}
			add_opinion = {
				who = ROOT
				modifier = cyrodiil_count_count
			}
		}
	}
}

# Warlord Relations Penalty
country_event = {
	id = cyrodiil.12
	title = "cyrodiil.12.t"
	desc = "cyrodiil.12.d"
	picture = COURT_eventPicture
	hidden = yes

	trigger = {
		government = cyrodilic_warlord
		NOT = { owns_core_province = 3529 } # Imperial City
		any_country = {
			OR = {
				culture_group = cyrodillic
				culture_group = colovian
			}
			NOT = { government = cyrodilic_warlord }
			NOT = {
				has_opinion_modifier = {
					who = ROOT
					modifier = cyrodiil_warlord_other_opinion
				}
			}
		}
	}
	
	option = {
		name = "cyrodiil.12.a"
		every_country = {
			limit = {
				OR = {
					culture_group = cyrodillic
					culture_group = colovian
				}
				NOT = { government = cyrodilic_warlord }
				NOT = {
					has_opinion_modifier = {
						who = ROOT
						modifier = cyrodiil_warlord_other_opinion
					}
				}
			}
			add_opinion = {
				who = ROOT 
				modifier = cyrodiil_warlord_other_opinion
			}
		}
	}
}

# Emperor-Warlord Relations
country_event = {
	id = cyrodiil.13
	title = "cyrodiil.13.t"
	desc = "cyrodiil.13.d"
	picture = COURT_eventPicture
	hidden = yes

	trigger = {
		government = cyrodilic_warlord
		NOT = { has_country_flag = ruby_throne }
		any_country = {
			has_country_flag = ruby_throne
			NOT = {
				has_opinion_modifier = {
					who = ROOT
					modifier = cyrodiil_warlord_other_opinion
				}
			}
		}
	}
	
	option = {
		name = "cyrodiil.13.a"
		every_country = {
			limit = {
				has_country_flag = ruby_throne
				NOT = {
					has_opinion_modifier = {
						who = ROOT
						modifier = cyrodiil_warlord_other_opinion
					}
				}
			}
			add_opinion = {
				who = ROOT
				modifier = cyrodiil_warlord_other_opinion
			}
		}
	}
}

## Elsweyr-Cyrodiil Relations
#country_event = {
#	id = cyrodiil.14
#	title = "cyrodiil.14.t"
#	desc = "cyrodiil.14.d"
#	picture = COURT_eventPicture
#	hidden = yes
#
#	# TODO
#	# Might not bother with this one
#}